<CascadingValue Value="this">
    <nav id="side-menu" class="navbar">
        <div class="navbar-wrapper">
            <div class="navbar-brand">
                <a href="/dashboard">
                    <img src="https://teledolar.com/wp-content/uploads/2021/03/Logo-TD.svg" />
                </a>
                <a href="" class="close-menu" onclick="javascript:ToggleMenu()" @onclick:preventDefault><i class="feather icon-x"></i></a>
            </div>

            <div class="navbar-content">
                <ul class="inner-navbar">
                    <TNNavSeparator />
                    <TNNavMenuItem Url="/dashboard" Icon="feather icon-home" Text="Home" />
                    <TNNavMenuItem Url="/remittances" Icon="feather icon-credit-card" Text="Remesas">
                        <TNNavMenuItem Url="/remittances/send" Text="Envíos" />
                        <TNNavMenuItem Url="/remittances/receive" Text="Recepciones" />
                    </TNNavMenuItem>
                    <TNNavMenuItem Url="/login" Icon="feather icon-globe" Text="Ubicaciones" />
                    <TNNavMenuItem Url="/login" Icon="feather icon-briefcase" Text="Promociones" />
                    <TNNavMenuItem Url="/login" Icon="feather icon-settings" Text="Configuración" />
                </ul>
            </div>
        </div>
    </nav>
</CascadingValue>

@code {
    [Inject] protected IJSRuntime JSRuntime { get; set; }
    [Inject] protected NavigationManager NavigationManager { get; set; }

    private List<TNNavMenuItem> NavMenuItems = new List<TNNavMenuItem>();

    internal void AddMenuItem(TNNavMenuItem navMenuItem)
    {
        NavMenuItems.Add(navMenuItem);
    }

    public Task OpenSubMenu(TNNavMenuItem navMenuItem)
    {
        foreach (var item in NavMenuItems.Where(q => !q.Equals(navMenuItem) && !q.NavSubMenuItems.Any(p => p.Equals(navMenuItem))))
            item.SubMenuOpened = false;

        navMenuItem.SubMenuOpened = !navMenuItem.SubMenuOpened;

        this.StateHasChanged();

        return Task.CompletedTask;
    }

    public async Task SelectMenuItem(TNNavMenuItem navMenuItem)
    {
        foreach (var item in NavMenuItems.Where(q => !q.Equals(navMenuItem)))
            item.Selected = false;

        navMenuItem.Selected = true;

        await JSRuntime.ToggleMenu();

        RedirectToUrl(navMenuItem.Url);

        this.StateHasChanged();
    }

    private void RedirectToUrl(string url)
    {
        NavigationManager.NavigateTo(url);
    }
}